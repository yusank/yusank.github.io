const throttle=(fn,wait)=>{let inThrottle,lastFn,lastTime;return function(){const context=this,args=arguments;if(!inThrottle){fn.apply(context,args);lastTime=Date.now();inThrottle=true;}else{clearTimeout(lastFn);lastFn=setTimeout(function(){if(Date.now()-lastTime>=wait){fn.apply(context,args);lastTime=Date.now();}},Math.max(wait-(Date.now()-lastTime),0));}};};const delayTime=420;;const headerFallbackWidth='36em';const headerInner=document.querySelector('.header-inner');const mainInner=document.querySelector('.main-inner');if(mainInner!==null){const mainInnerWidth=window.getComputedStyle(mainInner,null).getPropertyValue('width');headerInner.style.setProperty('--main-inner',mainInnerWidth);}else{headerInner.style.setProperty('--main-inner',headerFallbackWidth);}
headerInner.style.setProperty('opacity',1);function addDisplayNone(e){const ele=document.getElementById(e);if(ele!==null){const hide=ele.getAttribute('data-hide');if(hide!==null){ele.parentNode.style='display: none';}}}
addDisplayNone('theme-switcher');addDisplayNone('lang-switcher');;const navToggleLabel=document.querySelector('.nav-toggle');const navToggleLabelInner=document.createElement('div');navToggleLabelInner.className='nav-toggle-inner';navToggleLabel.appendChild(navToggleLabelInner);for(let i=0;i<3;i++){const span=document.createElement('span');navToggleLabelInner.appendChild(span);}
const navToggle=document.getElementById('nav-toggle');const header=document.querySelector('.header');const navCurtain=document.querySelector('.nav-curtain');navToggle.addEventListener('change',(e)=>{if(e.target.checked){header.classList.add('open');navToggleLabel.classList.add('open');header.classList.remove('fade');navCurtain.style='display: block';}else{header.classList.remove('open');navToggleLabel.classList.remove('open');header.classList.add('fade');}});navCurtain.addEventListener('animationend',(e)=>{if(!navToggle.checked){e.target.removeAttribute('style');}});window.addEventListener('scroll',throttle(function(){closeNav();},delayTime));window.addEventListener('resize',throttle(function(){closeNav();},delayTime));function closeNav(){if(navToggle.checked){navToggle.checked=false;header.classList.remove('open');navToggleLabel.classList.remove('open');header.classList.add('fade');}};const backToTop=document.getElementById('back-to-top');if(backToTop!==null){window.addEventListener('scroll',throttle(function(){window.scrollY>100?backToTop.classList.add('show'):backToTop.classList.remove('show');},delayTime));};if(userPrefers==='dark'){changeMode('dark');}else if(userPrefers==='light'){changeMode('light');}else if(darkModeMediaQuery.matches){changeMode('dark');}else if(lightModeMediaQuery.matches){changeMode('light');}
darkModeMediaQuery.addListener((e)=>{const darkModeOn=e.matches;if(darkModeOn){changeModeMeta('dark');changeMode('dark');setMode('dark');}});lightModeMediaQuery.addListener((e)=>{const lightModeOn=e.matches;if(lightModeOn){changeModeMeta('light');changeMode('light');setMode('light');}});const themeSwitcher=document.getElementById('theme-switcher');themeSwitcher.addEventListener('click',function(){const currentMode=document.documentElement.getAttribute('data-theme');if(currentMode==='dark'){changeModeMeta('light');changeMode('light');setMode('light');}else{changeModeMeta('dark');changeMode('dark');setMode('dark');}});window.addEventListener('storage',function(event){if(event.newValue==='dark'){changeModeMeta('dark');changeMode('dark');}else{changeModeMeta('light');changeMode('light');}});function changeMode(theme){var isDark=theme==='dark';document.getElementById('theme-switcher').innerHTML=isDark?'ðŸŒ™':'ðŸŒž';var oldChromaTheme=isDark?'chroma':'chroma-dark';var newChromaTheme=isDark?'chroma-dark':'chroma';[].slice.apply(document.getElementsByClassName(oldChromaTheme)).forEach((e)=>{e.className=newChromaTheme;});}
function setMode(theme){window.localStorage.setItem('theme',theme);};document.querySelectorAll('table').forEach((e)=>{e.outerHTML=`<div class="table-container">${e.outerHTML}</div>`;});;const commentsToggle=document.getElementById('load-comments');if(commentsToggle!==null){commentsToggle.addEventListener('click',function(){loadComments();this.style="display: none";});};